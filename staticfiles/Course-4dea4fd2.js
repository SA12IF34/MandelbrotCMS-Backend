import{f as y,r as d,j as e,g}from"./index-3a55f404.js";import{c as h,d as u}from"./index-ee7d2108.js";import{a as c}from"./api-5ce17b8f.js";import{A as N}from"./index-af17fb20.js";import{F as b}from"./FadeLoader-67dce3f5.js";import{h as o}from"./api-d470eb0d.js";import"./iconBase-10535e60.js";function A(){var f;const{id:i}=y(),[s,m]=d.useState(),[x,k]=d.useState(50);async function j(){var t;try{m(void 0);const a=await c.get(`courses/${i}/`);if(a.status===200){const n=await a.data;document.title=n.title,m(n)}}catch(a){a instanceof N&&((t=a.response)==null?void 0:t.status)===404&&(window.location.href="/learning-tracker/not-found"),o(a)}}async function r(t){try{(await c.patch(`courses/${i}/`,t)).status===202&&j()}catch(a){o(a)}}async function w(){try{(await c.delete(`courses/${i}/`)).status===204&&window.history.back()}catch(t){o(t)}}async function C(t,a){try{if(t.preventDefault(),(s==null?void 0:s.status)==="done")return;const n=t.target.firstElementChild,l=!n.checked,p=await c.patch(`update-section/${a}/`,{done:l});p.status===202?(n.checked=l,l?((s==null?void 0:s.status)==="later"&&r({status:"current"}),g.createRoot(t.target.lastElementChild).render(e.jsx(h,{color:"gold"}))):(document.querySelectorAll(".section input:checked").length===0&&r({status:"later"}),g.createRoot(t.target.lastElementChild).render(e.jsx(u,{color:"#c0c0c0"})))):p.status===200&&window.location.reload()}catch(n){o(n)}}return d.useEffect(()=>{window.matchMedia("(max-width: 545px)").matches&&k(20),j()},[]),e.jsx("div",{className:"page course-page",children:s?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("div",{className:"image",children:e.jsx("img",{src:s.image,alt:""})}),e.jsx("h2",{children:s.title}),e.jsxs("div",{className:"info",children:[e.jsx("span",{className:"status",children:s.status}),e.jsxs("span",{className:"source",children:["source: ",e.jsx("a",{target:"_blank",href:s.link,children:s.link.length>x?s.link.slice(0,x+1)+"...":s.link})]})]})]}),e.jsx("div",{children:s.list?e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:"Sections"}),e.jsx("br",{}),e.jsx("div",{className:"sections",children:(f=s.sections)==null?void 0:f.map(t=>e.jsxs("div",{className:"section",children:[e.jsx("h4",{children:t.title}),e.jsxs("label",{onClick:a=>{C(a,t.id)},htmlFor:"done-section",children:[e.jsx("input",{checked:!!t.done,type:"checkbox",name:"",id:"done-section"}),e.jsx("button",{children:t.done?e.jsx(h,{color:"gold"}):e.jsx(u,{color:"#c0c0c0"})})]})]}))})]}):s.status==="later"?e.jsx(e.Fragment,{children:e.jsx("button",{onClick:()=>{r({status:"current"})},className:"change-status",children:"Start Course"})}):s.status==="current"?e.jsx(e.Fragment,{children:e.jsxs("button",{onClick:()=>{r({status:"done"})},className:"change-status",children:["Done ",e.jsx(u,{color:"#c0c0c0"})]})}):e.jsx(e.Fragment,{children:e.jsxs("button",{className:"done-status",children:["Done ",e.jsx(h,{color:"gold"})]})})}),e.jsx("button",{onClick:w,className:"delete-course",children:"Delete"})]}):e.jsx(b,{color:"#c0c0c0",height:18,width:6})})}export{A as default};
