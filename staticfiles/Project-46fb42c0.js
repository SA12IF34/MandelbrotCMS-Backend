import{r,f as F,b as P,j as e}from"./index-3a55f404.js";import{a as m,I as k}from"./index-e59a6ce4.js";import{C as v}from"./index-acd746af.js";import{A as E}from"./index-af17fb20.js";import{a as n}from"./api-d686495a.js";import{F as S}from"./FadeLoader-67dce3f5.js";import{h as i}from"./api-d470eb0d.js";import"./iconBase-10535e60.js";function q(){var b;const[a,y]=r.useState(),[N,d]=r.useState(!1),[D,h]=r.useState(!1),p=r.useRef(null),j=r.useRef(null),{id:f}=F(),u=P();async function o(){try{const t=await n.get(`projects/${f}/`);if(t.status===200){const s=await t.data;document.title=s.title,y(s)}}catch(t){t instanceof E&&(t.status===404?u("/sessions-manager/not-found/"):i(t))}}async function c(t){try{(await n.patch(`projects/${f}/`,t)).status===202&&o()}catch(s){i(s)}}async function x(){try{(await n.delete(`projects/${f}/`)).status===204&&u("/sessions-manager/")}catch(t){i(t)}}async function C(t){var s;try{let l=!0;if(((s=a==null?void 0:a.partitions)==null?void 0:s.length)===1&&(confirm("Deleting the last partition will delete the whole project.")||(l=!1)),l){const g=await n.delete(`partitions/${t}/`);g.status===202?o():g.status===204&&x()}}catch(l){i(l)}}async function w(t){try{const s=await n.patch(`partitions/${t}/`,{done:!0});s.status===202?o():s.status===200&&window.location.reload()}catch(s){i(s)}}return r.useEffect(()=>{o()},[]),e.jsx("div",{className:"page project-page",children:a?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"info",children:[e.jsx("h2",{children:a.title}),e.jsx("br",{}),e.jsx("p",{children:a.description})]}),e.jsxs("div",{className:"dates",children:[e.jsxs("div",{style:{alignItems:"center"},children:[e.jsx("h3",{children:"Start Date:"}),N?e.jsxs(e.Fragment,{children:[e.jsx("input",{ref:p,type:"date",name:"",id:""}),e.jsx("button",{className:"prepare-btn",onClick:()=>{var t;(t=p.current)!=null&&t.value?(c({start_date:p.current.value}),d(!1)):(c({start_date:null}),d(!1))},children:e.jsx(m,{})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("h3",{children:["  ",a.start_date?a.start_date:e.jsx("span",{style:{fontStyle:"italic"},children:"Indertermined"})]}),"  ",e.jsx("button",{className:"prepare-btn",onClick:()=>{d(!0)},children:e.jsx(v,{})})]})]}),e.jsxs("div",{children:[e.jsx("h3",{children:"Finish Date:"}),D?e.jsxs(e.Fragment,{children:[e.jsx("input",{ref:j,type:"date"}),e.jsx("button",{className:"prepare-btn",onClick:()=>{var t;(t=j.current)!=null&&t.value?(c({finish_date:j.current.value}),h(!1)):(c({finish_date:null}),h(!1))},children:e.jsx(m,{})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("h3",{children:["  ",a.finish_date?a.finish_date:e.jsx("span",{style:{fontStyle:"italic"},children:"Indetermined"})]}),"  ",e.jsx("button",{className:"prepare-btn",onClick:()=>{h(!0)},children:e.jsx(v,{})})]})]})]}),e.jsxs("div",{className:"partitions",children:[e.jsx("h2",{children:"Partitions"}),e.jsx("br",{}),e.jsx("div",{className:"partitions-container",children:(b=a.partitions)==null?void 0:b.map(t=>e.jsxs("div",{className:`partition ${t.done&&"done"}`,children:[e.jsx("h3",{children:t.title}),t.description&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("p",{children:t.description})]}),!t.done&&e.jsx("button",{onClick:()=>{w(t.id)},title:"complete partition",className:"complete-partition prepare-btn",children:e.jsx(m,{})}),e.jsx("button",{onClick:()=>{C(t.id)},title:"remove partition",className:"remove-partition prepare-btn",children:e.jsx(k,{})})]}))})]}),e.jsx("button",{onClick:x,title:"delete project",className:"delete-project",children:"Delete Project"})]}):e.jsx(S,{color:"#808080",height:18,width:6})})}export{q as default};
