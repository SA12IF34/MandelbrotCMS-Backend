import{r as c,b as y,j as e}from"./index-3a55f404.js";import{L as E}from"./index-2274eb4d.js";import{a as R}from"./api-d686495a.js";import{I as D}from"./index-e59a6ce4.js";import{h as S}from"./api-d470eb0d.js";import"./iconBase-10535e60.js";function I(){document.title="New Project";const[o,m]=c.useState([]),[f,d]=c.useState(!1),j=c.useRef(null),h=c.useRef(null),u=c.useRef(null),p=c.useRef(null),v=y();async function b(){var r,t,s,n,i,l;try{const a=((r=u.current)==null?void 0:r.value).length>0?(t=u.current)==null?void 0:t.value:null,N=((s=p.current)==null?void 0:s.value).length>0?(n=p.current)==null?void 0:n.value:null,g={project:{title:(i=j.current)==null?void 0:i.value,description:(l=h.current)==null?void 0:l.value,start_date:a,finish_date:N},partitions:o},x=await R.post("projects/",g);if(x.status===201){const P=await x.data;v(`/sessions-manager/projects/${P.id}`)}}catch(a){S(a)}}return e.jsx("div",{className:"page new-project-page",children:e.jsxs("form",{onSubmit:r=>{r.preventDefault()},children:[e.jsxs("section",{className:"info",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"title",className:"important",children:"Project Title"}),e.jsx("input",{ref:j,required:!0,type:"text",name:"title",id:"title"})]}),e.jsx("br",{}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"desc",className:"important",children:"Project Description"}),e.jsx("textarea",{ref:h,required:!0,name:"desc",id:"desc"})]})]}),e.jsxs("section",{className:"partitions",children:[e.jsxs("div",{className:"label",children:[e.jsx("h2",{children:"Partitions"}),e.jsx("button",{title:"add partition",onClick:()=>{d(!0)},className:"prepare-btn",children:e.jsx(E,{})})]}),e.jsx("div",{className:"partitions-container",children:o.map(r=>e.jsxs("div",{className:"partition",children:[e.jsx("h3",{children:r.title}),r.description&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("p",{children:r.description})]}),e.jsx("button",{onClick:()=>{m(o.filter(t=>t.title!==r.title))},title:"remove partition",className:"remove-partition prepare-btn",children:e.jsx(D,{})})]}))}),f&&e.jsxs("div",{className:"partition-form",children:[e.jsxs("div",{children:[e.jsx("input",{type:"text",placeholder:"title"}),e.jsx("textarea",{placeholder:"description"})]}),e.jsxs("div",{children:[e.jsx("button",{onClick:r=>{var n,i,l,a;const t=(i=(n=r.target.parentElement)==null?void 0:n.parentElement)==null?void 0:i.querySelector("input"),s=(a=(l=r.target.parentElement)==null?void 0:l.parentElement)==null?void 0:a.querySelector("textarea");if((t==null?void 0:t.value.length)===0){alert("Partition must have at least a title.");return}m([...o,{title:t==null?void 0:t.value,description:s==null?void 0:s.value}]),t&&s&&(t.value="",s.value=""),d(!1)},children:"Add"}),e.jsx("button",{onClick:r=>{var n,i,l,a;const t=(i=(n=r.target.parentElement)==null?void 0:n.parentElement)==null?void 0:i.querySelector("input"),s=(a=(l=r.target.parentElement)==null?void 0:l.parentElement)==null?void 0:a.querySelector("textarea");t&&s&&(t.value="",s.value=""),d(!1)},children:"Cancel"})]})]})]}),e.jsxs("section",{className:"dates",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"s-date",children:"Start Date"}),e.jsx("input",{ref:u,type:"date",name:"s-date",id:"s-date"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"f-date",children:"Finish Date"}),e.jsx("input",{ref:p,type:"date",name:"f-date",id:"f-date"})]})]}),e.jsx("button",{onClick:b,type:"submit",title:"add project",className:"add-project",children:"Add Project"})]})})}export{I as default};
